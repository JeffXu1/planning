/**
 * @file spiral_smoother_main.cpp
 * @brief 对比各个平滑器的耗时以及拟合效果
 * @author Wang Dezhao (1282507109@qq.com)
 * @version 1.0
 * @date 2022-06-07 15:30:50
 *
 * @copyright Copyright (c) 2022
 */

#include <chrono>
#include <fstream>
#include <iomanip>
#include <iostream>
#include <sstream>

//#include "../math/math_method/curve_math.h"
#include "curve.h"
#include "curve_creator.h"
#include "curve_segment.h"
#include "matplotlibcpp.h"
#include "osqp_spline_2d_solver.h"
#include "spiral_reference_line_smoother.h"

// reference
#include "curve.h"
#include "curve_creator.h"
#include "curve_segment.h"
using namespace reference_line;

using apollo::common::math::Vec2d;
using Eigen::MatrixXd;
using namespace apollo;
using namespace planning;
namespace plt = matplotlibcpp;

template <typename T>
using vector_Eigen = std::vector<T, Eigen::aligned_allocator<T>>;

template <typename T>
T calc_point_theta(T y_x_t, T x) {
  return std::atan2(y_x_t, x);
};

void cal_path_kappa(std::vector<double> &raw_xs, std::vector<double> &raw_ys,
                    std::vector<double> &final_kappas,
                    std::vector<double> &final_dkappas) {
  reference_line::CurveCreator creator(raw_xs, raw_ys);
  final_kappas = creator.curve().get()->kappas();
  final_dkappas = creator.curve().get()->dkappas();
#if 0
  creator.solve();

  auto &curve = creator.curve();
  double length = curve->length();

  // constexpr int N = 200;
  int N = raw_xs.size() - 1;
  double stride = length / N;

  // std::vector<double> final_xs, final_ys, final_kappas, final_dkappas,
  std::vector<double> final_deltas;
  final_deltas = curve->deltas_;

  for (double i = 0; i < N + 1; i++) {
    // final_xs.emplace_back(curve->x(i * stride));
    // final_ys.emplace_back(curve->y(i * stride));
    final_kappas.emplace_back(curve->kappa(i * stride));
    final_dkappas.emplace_back(curve->dkappa(i * stride));
  }
#endif
}

namespace apollo::planning {
/**
 * @brief 等距弧长离散园
 * 由于圆的特殊性，其圆弧上每一点的曲率均相等，故可以将等弧长与相同的角度相对应
 * @param  x
 * @param  y
 * @param  r
 * @param  size
 */
void div_circle(std::vector<double> &x, std::vector<double> &y, double r,
                double size)  // xy对应圆心坐标,r为半径,size用于设置划分的间距
{
  double angle_step = 0;  //一小步的弧度
  angle_step = size / r;
  double x_out, y_out;

  for (int i = M_PI / angle_step; i > 0; --i) {
    x_out = r * cos(i * angle_step);
    y_out = r * sin(i * angle_step);
    x.push_back(x_out);
    y.push_back(y_out);
  }
}
}  // namespace apollo::planning

void read_csv(std::vector<Eigen::Vector2d> &raw_points_) {
  std::ifstream inFile(
      "/home/next/routing_planning/Notes/osqp_eigen/path_points.csv",
      std::ios::in);
  std::string lineStr;
  char delim = ',';
  if (!inFile) {
    std::cout << "打开文件失败！" << std::endl;
  }
  std::vector<double> raw_xs, raw_ys;
  getline(inFile, lineStr);
  while (getline(inFile, lineStr)) {
    std::stringstream ss(lineStr);
    std::string str;
    std::vector<double> points;
    while (getline(ss, str, delim)) {
      points.emplace_back(std::stod(str));
    }
    raw_xs.emplace_back(points.at(0));
    raw_ys.emplace_back(points.at(1));
  }

  raw_points_.resize(raw_xs.size());

  for (size_t i = 0; i < raw_xs.size(); ++i) {
    raw_points_[i] = {raw_xs[i], raw_ys[i]};
  }
}

void write_to_csv(std::vector<double> &r_x_, std::vector<double> &r_y_) {
  std::ofstream outFile;
  outFile.open("solve_path_points.csv", std::ios::out);
  outFile << "x_value" << ',' << "y_value" << '\n';
  for (size_t i = 0; i < r_x_.size(); ++i) {
    outFile << r_x_.at(i) << ',' << r_y_.at(i) << '\n';
  }
  outFile.close();
}

void SetPoints(std::vector<Eigen::Vector2d> &raw_points_) {
#if 0
  raw_points_.resize(4);
  raw_points_[0] = {0.0, 0.0};
  raw_points_[1] = {1.0, 0.3};
  raw_points_[2] = {2.0, 0.0};
  raw_points_[3] = {3, 0.1};
#endif

#if 0
  std::vector<double> raw_xs, raw_ys;
  div_circle(raw_xs, raw_ys, 5, 1);

  raw_points_.resize(raw_xs.size());

  for (size_t i = 0; i < raw_xs.size(); ++i) {
    raw_points_[i] = {raw_xs[i], raw_ys[i]};
  }
#endif

#if 1
  raw_points_.resize(21);

  raw_points_[0] = {4.946317773, 0.08436953512};
  raw_points_[1] = {5.017218975, 0.7205757236};
  raw_points_[2] = {4.734635316, 1.642930209};
  raw_points_[3] = {4.425064575, 2.365356462};
  raw_points_[4] = {3.960102096, 2.991632152};
  raw_points_[5] = {3.503172702, 3.44091492};
  raw_points_[6] = {2.989950824, 3.9590821};
  raw_points_[7] = {2.258523535, 4.554377368};
  raw_points_[8] = {1.562447892, 4.656801472};
  raw_points_[9] = {0.8764776599, 4.971705856};
  raw_points_[10] = {0.09899323097, 4.985845841};
  raw_points_[11] = {-0.7132021974, 5.010851105};
  raw_points_[12] = {-1.479055426, 4.680181989};
  raw_points_[13] = {-2.170306775, 4.463442715};
  raw_points_[14] = {-3.034455492, 4.074651273};
  raw_points_[15] = {-3.621987909, 3.585790302};
  raw_points_[16] = {-3.979289889, 3.014232351};
  raw_points_[17] = {-4.434628966, 2.367848826};
  raw_points_[18] = {-4.818245921, 1.467395733};
  raw_points_[19] = {-4.860190444, 0.8444358019};
  raw_points_[20] = {-5.09947597, -0.01022405467};
#endif
}

namespace apollo::planning {
void qp_spline_smoother(const std::vector<Eigen::Vector2d> &raw_points_,
                        std::vector<double> &sloveX,
                        std::vector<double> &sloveY) {
  // qp_spline
  std::vector<double> t_knots_;
  uint32_t num_spline = 2;
  for (std::uint32_t i = 0; i <= num_spline; ++i) {
    t_knots_.push_back(i * 1.0);
  }

  uint32_t order = 5;
  OsqpSpline2dSolver spline_solver(t_knots_, order);

  Spline2dConstraint *constraint = spline_solver.mutable_constraint();
  Spline2dKernel *kernel = spline_solver.mutable_kernel();

  std::vector<double> t_coord;
  vector_Eigen<Eigen::Vector2d> ref_ft;
  std::vector<Vec2d> ref_point;
  std::vector<double> ref_x, ref_y;
  std::vector<double> lateral_bound, longitudinal_bound;
  std::vector<double> ref_theta;
  std::vector<double> constraint_x, constraint_y;

  constraint_x.clear();
  constraint_y.clear();

  for (size_t i = 0; i < raw_points_.size(); ++i) {
    constraint_x.push_back(raw_points_.at(i).x());
    constraint_y.push_back(raw_points_.at(i).y());

    t_coord.emplace_back(i * 0.25);
    Vec2d prev_point(constraint_x[i], constraint_y[i]);

    Vec2d new_point = prev_point;
    ref_x.push_back(new_point.x());
    ref_y.push_back(new_point.y());
    ref_point.emplace_back(new_point.x(), new_point.y());
    longitudinal_bound.emplace_back(0.2);
    lateral_bound.emplace_back(0.2);
  }

  for (size_t i = 0; i < constraint_x.size() - 1; ++i) {
    double delta_y = constraint_y.at(i + 1) - constraint_y.at(i);
    double delta_x = constraint_x.at(i + 1) - constraint_x.at(i);
    double theta = calc_point_theta(delta_y, delta_x);
    // std::cout << "theta:" << theta << "\n";
    ref_theta.push_back(theta);
  }

  ref_theta.push_back(
      calc_point_theta(constraint_y.at(constraint_y.size() - 1) -
                           constraint_y.at(constraint_y.size() - 2),
                       constraint_x.at(constraint_x.size() - 1) -
                           constraint_x.at(constraint_x.size() - 2)));

  constraint->Add2dBoundary(t_coord, ref_theta, ref_point, longitudinal_bound,
                            lateral_bound);
  constraint->AddThirdDerivativeSmoothConstraint();
  kernel->AddThirdOrderDerivativeMatrix(200);
  kernel->AddSecondOrderDerivativeMatrix(100);
  kernel->AddDerivativeKernelMatrix(10);

  // 正则化
  kernel->AddRegularization(100);
  constraint->AddPointAngleConstraint(0, 1.45981);
  // TODO(all): fix the test.
  auto start = std::chrono::system_clock::now();
  if (spline_solver.Solve()) {
    std::cout << "solve successful" << std::endl;
  }
  auto end = std::chrono::system_clock::now();
  std::chrono::duration<double> diff = end - start;
  std::cout << "Time to solver is " << diff.count() << " s\n";

  // 提取优化结果
  for (auto const t : t_coord) {
    auto xy = spline_solver.spline()(t);
    sloveX.emplace_back(xy.first);
    sloveY.emplace_back(xy.second);
  }
}
}  // namespace apollo::planning

namespace apollo::planning {
void spiral_smoother(std::vector<Eigen::Vector2d> &raw_points_,
                     std::vector<double> *theta, std::vector<double> *kappa,
                     std::vector<double> *dkappa, std::vector<double> *s,
                     std::vector<double> *spiral_x,
                     std::vector<double> *spiral_y) {
  SpiralReferenceLineSmoother spiral_smoother_;
  spiral_smoother_.SmoothStandAlone(raw_points_, theta, kappa, dkappa, s,
                                    spiral_x, spiral_y);
}
}  // namespace apollo::planning

namespace apollo::planning {
using namespace reference_line;

void hermit_spiral(std::vector<double> &raw_xs, std::vector<double> &raw_ys,
                   std::vector<double> &sloveX, std::vector<double> &sloveY) {
  CurveCreator creator(raw_xs, raw_ys);
  creator.solve();
  auto &curve = creator.curve();

  double length = curve->length();

  // constexpr int N = 44;
  int N = raw_xs.size() - 1;

  double stride = length / N;

  for (double i = 0; i < N + 1; i++) {
    sloveX.emplace_back(curve->x(i * stride));
    sloveY.emplace_back(curve->y(i * stride));
  }
}
}  // namespace apollo::planning

int main() {
#if 1
  std::vector<Eigen::Vector2d> raw_points_;
  std::vector<double> ref_x, ref_y;
  SetPoints(raw_points_);
  for (const auto &item : raw_points_) {
    ref_x.push_back(item.x());
    ref_y.push_back(item.y());
  }
#endif

#if 0
  std::vector<std::pair<double, double>> opt_path{{0, 0},
                                                  {0.250189, 1.02041e-05},
                                                  {0.500391, 2.75656e-05},
                                                  {0.752275, 5.17817e-05},
                                                  {1.00737, 0.000314583},
                                                  {1.26704, 0.00101651},
                                                  {1.53254, 0.0023361},
                                                  {1.80497, 0.00443505},
                                                  {2.08532, 0.0074604},
                                                  {2.37446, 0.0115446},
                                                  {2.67312, 0.0168045},
                                                  {2.98195, 0.0233389},
                                                  {3.30149, 0.0312266},
                                                  {3.63218, 0.0405245},
                                                  {3.97437, 0.0512655},
                                                  {4.32832, 0.0634581},
                                                  {4.69422, 0.0770863},
                                                  {5.07218, 0.0921107},
                                                  {5.46224, 0.108471},
                                                  {5.86438, 0.126086},
                                                  {6.27851, 0.144864},
                                                  {6.70451, 0.164697},
                                                  {7.14217, 0.185472},
                                                  {7.59128, 0.207074},
                                                  {8.05154, 0.229387},
                                                  {8.52264, 0.252297},
                                                  {9.00424, 0.2757},
                                                  {9.49595, 0.299498},
                                                  {9.99737, 0.323604},
                                                  {10.5081, 0.347938},
                                                  {11.0276, 0.372436},
                                                  {11.5555, 0.397038},
                                                  {12.0912, 0.421698},
                                                  {12.6344, 0.446376},
                                                  {13.1844, 0.471038},
                                                  {13.7409, 0.495659},
                                                  {14.3033, 0.520216},
                                                  {14.8711, 0.544693},
                                                  {15.4438, 0.569077},
                                                  {16.021, 0.593357},
                                                  {16.6022, 0.61753},
                                                  {17.1869, 0.641593},
                                                  {17.7748, 0.665553},
                                                  {18.3653, 0.68942},
                                                  {18.9581, 0.713213},
                                                  {19.5528, 0.736962},
                                                  {20.149, 0.760704},
                                                  {20.7465, 0.784491},
                                                  {21.3448, 0.808387},
                                                  {21.9438, 0.832468},
                                                  {22.5432, 0.856828},
                                                  {23.1427, 0.881572},
                                                  {23.7422, 0.906819},
                                                  {24.3415, 0.932701},
                                                  {24.9405, 0.959357},
                                                  {25.5388, 0.986932},
                                                  {26.1365, 1.01557},
                                                  {26.7331, 1.04542},
                                                  {27.3287, 1.07662},
                                                  {27.9228, 1.10929},
                                                  {28.5154, 1.14353},
                                                  {29.1063, 1.17942},
                                                  {29.6952, 1.217},
                                                  {30.2819, 1.25629},
                                                  {30.8663, 1.29725},
                                                  {31.4482, 1.33979},
                                                  {32.0273, 1.38378},
                                                  {32.6035, 1.42904},
                                                  {33.1766, 1.47534},
                                                  {33.7466, 1.5224},
                                                  {34.3131, 1.5699},
                                                  {34.8761, 1.61751},
                                                  {35.4355, 1.66486},
                                                  {35.9911, 1.71157},
                                                  {36.5428, 1.75725},
                                                  {37.0905, 1.80153},
                                                  {37.634, 1.84404},
                                                  {38.1733, 1.88444},
                                                  {38.7083, 1.92244},
                                                  {39.2387, 1.95777},
                                                  {39.7646, 1.99026},
                                                  {40.2857, 2.01977},
                                                  {40.802, 2.04625},
                                                  {41.3134, 2.06974},
                                                  {41.8197, 2.09037},
                                                  {42.3208, 2.10836},
                                                  {42.8167, 2.12402},
                                                  {43.3073, 2.13779},
                                                  {43.7924, 2.15018},
                                                  {44.2721, 2.16182},
                                                  {44.7462, 2.17341},
                                                  {45.2147, 2.18577},
                                                  {45.6776, 2.19975},
                                                  {46.1347, 2.21632},
                                                  {46.5861, 2.23648},
                                                  {47.0316, 2.26127},
                                                  {47.4711, 2.29176},
                                                  {47.9044, 2.32906},
                                                  {48.3314, 2.37426},
                                                  {48.7518, 2.42842},
                                                  {49.1651, 2.49259},
                                                  {49.5711, 2.56773},
                                                  {49.9692, 2.65476},
                                                  {50.3589, 2.75447},
                                                  {50.7394, 2.86755},
                                                  {51.11, 2.99456},
                                                  {51.47, 3.1359},
                                                  {51.8185, 3.29183},
                                                  {52.1547, 3.46242},
                                                  {52.4776, 3.64758},
                                                  {52.7865, 3.84703},
                                                  {53.0804, 4.06033},
                                                  {53.3588, 4.28686},
                                                  {53.6209, 4.52588},
                                                  {53.8662, 4.77651},
                                                  {54.0944, 5.03776},
                                                  {54.3051, 5.30858},
                                                  {54.4984, 5.58788},
                                                  {54.6743, 5.87454},
                                                  {54.833, 6.16746},
                                                  {54.975, 6.4656},
                                                  {55.1007, 6.76796},
                                                  {55.2107, 7.07364},
                                                  {55.3058, 7.38181},
                                                  {55.3866, 7.69176},
                                                  {55.4541, 8.00289},
                                                  {55.5091, 8.31469},
                                                  {55.5522, 8.62679},
                                                  {55.5841, 8.93891},
                                                  {55.605, 9.25083},
                                                  {55.615, 9.5624},
                                                  {55.614, 9.87344},
                                                  {55.6021, 10.1838},
                                                  {55.5788, 10.4932},
                                                  {55.5438, 10.8015},
                                                  {55.4968, 11.1084},
                                                  {55.4372, 11.4135},
                                                  {55.3646, 11.7164},
                                                  {55.2784, 12.0165},
                                                  {55.1781, 12.3133},
                                                  {55.0634, 12.6062},
                                                  {54.9337, 12.8942},
                                                  {54.7886, 13.1767},
                                                  {54.6281, 13.4526},
                                                  {54.4517, 13.7212},
                                                  {54.2596, 13.9814},
                                                  {54.0518, 14.2323},
                                                  {53.8285, 14.4729},
                                                  {53.59, 14.7023},
                                                  {53.3368, 14.9197},
                                                  {53.0694, 15.1243},
                                                  {52.7886, 15.3157},
                                                  {52.4951, 15.4932},
                                                  {52.1896, 15.6565},
                                                  {51.8731, 15.8054},
                                                  {51.5463, 15.94},
                                                  {51.21, 16.0602},
                                                  {50.8651, 16.1664},
                                                  {50.5123, 16.2589},
                                                  {50.1522, 16.3383},
                                                  {49.7856, 16.405},
                                                  {49.4129, 16.46},
                                                  {49.0346, 16.5038},
                                                  {48.6511, 16.5374},
                                                  {48.2628, 16.5617},
                                                  {47.8698, 16.5776},
                                                  {47.4724, 16.586},
                                                  {47.0707, 16.5879},
                                                  {46.6648, 16.5842},
                                                  {46.2548, 16.5758},
                                                  {45.8407, 16.5636},
                                                  {45.4227, 16.5486},
                                                  {45.0006, 16.5314},
                                                  {44.5745, 16.5127},
                                                  {44.1444, 16.4934},
                                                  {43.7104, 16.474},
                                                  {43.2725, 16.455},
                                                  {42.8308, 16.437},
                                                  {42.3853, 16.4203},
                                                  {41.9361, 16.4052},
                                                  {41.4832, 16.3921},
                                                  {41.0268, 16.3811},
                                                  {40.567, 16.3724},
                                                  {40.1039, 16.366},
                                                  {39.6375, 16.362},
                                                  {39.168, 16.3603},
                                                  {38.6955, 16.3609},
                                                  {38.2202, 16.3638},
                                                  {37.7421, 16.3687},
                                                  {37.2614, 16.3756},
                                                  {36.7781, 16.3842},
                                                  {36.2924, 16.3944},
                                                  {35.8044, 16.406},
                                                  {35.3142, 16.4189},
                                                  {34.8219, 16.4328},
                                                  {34.3276, 16.4476},
                                                  {33.8315, 16.463},
                                                  {33.3335, 16.479},
                                                  {32.8339, 16.4954},
                                                  {32.3328, 16.5121},
                                                  {31.8301, 16.5289},
                                                  {31.3261, 16.5456},
                                                  {30.8208, 16.5624},
                                                  {30.3143, 16.5789},
                                                  {29.8067, 16.5953},
                                                  {29.2981, 16.6114},
                                                  {28.7886, 16.6271},
                                                  {28.2782, 16.6426},
                                                  {27.7672, 16.6577},
                                                  {27.2554, 16.6724},
                                                  {26.7431, 16.6868},
                                                  {26.2303, 16.7008},
                                                  {25.717, 16.7145},
                                                  {25.2034, 16.7278},
                                                  {24.6895, 16.7409},
                                                  {24.1754, 16.7537},
                                                  {23.6611, 16.7662},
                                                  {23.1466, 16.7785},
                                                  {22.6322, 16.7907},
                                                  {22.1177, 16.8026},
                                                  {21.6033, 16.8145},
                                                  {21.0889, 16.8262},
                                                  {20.5747, 16.8378},
                                                  {20.0607, 16.8494},
                                                  {19.5469, 16.8609},
                                                  {19.0333, 16.8724},
                                                  {18.52, 16.8839},
                                                  {18.007, 16.8954},
                                                  {17.4943, 16.907},
                                                  {16.982, 16.9185},
                                                  {16.47, 16.9301},
                                                  {15.9585, 16.9417},
                                                  {15.4473, 16.9533},
                                                  {14.9366, 16.965},
                                                  {14.4263, 16.9768},
                                                  {13.9164, 16.9886},
                                                  {13.407, 17.0004},
                                                  {12.8981, 17.0123},
                                                  {12.3896, 17.0242},
                                                  {11.8815, 17.0362},
                                                  {11.3739, 17.0481},
                                                  {10.8668, 17.0602},
                                                  {10.3602, 17.0722},
                                                  {9.85393, 17.0842},
                                                  {9.34817, 17.0963},
                                                  {8.84284, 17.1084},
                                                  {8.33794, 17.1205},
                                                  {7.83347, 17.1325},
                                                  {7.32942, 17.1446},
                                                  {6.82577, 17.1567},
                                                  {6.32252, 17.1688},
                                                  {5.81966, 17.1809},
                                                  {5.31716, 17.1929},
                                                  {4.81503, 17.205},
                                                  {4.31325, 17.217},
                                                  {3.81181, 17.229},
                                                  {3.31068, 17.241},
                                                  {2.80987, 17.253},
                                                  {2.30935, 17.265},
                                                  {1.80911, 17.2769},
                                                  {1.30914, 17.2889},
                                                  {0.809431, 17.3008},
                                                  {0.309959, 17.3127},
                                                  {-0.189286, 17.3246},
                                                  {-0.688316, 17.3365},
                                                  {-1.18715, 17.3484},
                                                  {-1.68579, 17.3603},
                                                  {-2.18425, 17.3721},
                                                  {-2.68256, 17.384},
                                                  {-3.18071, 17.3958},
                                                  {-3.67873, 17.4076},
                                                  {-4.17661, 17.4195},
                                                  {-4.67439, 17.4313},
                                                  {-5.17205, 17.4431},
                                                  {-5.66963, 17.4549},
                                                  {-6.16711, 17.4667},
                                                  {-6.66453, 17.4786},
                                                  {-7.16187, 17.4904},
                                                  {-7.65916, 17.5022},
                                                  {-8.1564, 17.514},
                                                  {-8.6536, 17.5258},
                                                  {-9.15076, 17.5376},
                                                  {-9.64789, 17.5494},
                                                  {-10.145, 17.5612},
                                                  {-10.6421, 17.573},
                                                  {-11.1392, 17.5848},
                                                  {-11.6363, 17.5966},
                                                  {-12.1334, 17.6085},
                                                  {-12.6304, 17.6203},
                                                  {-13.1275, 17.6321},
                                                  {-13.6246, 17.6439},
                                                  {-14.1218, 17.6557},
                                                  {-14.6189, 17.6675},
                                                  {-15.1161, 17.6794},
                                                  {-15.6132, 17.6912},
                                                  {-16.1104, 17.703},
                                                  {-16.6077, 17.7148},
                                                  {-17.1049, 17.7266},
                                                  {-17.6022, 17.7385},
                                                  {-18.0995, 17.7503},
                                                  {-18.5968, 17.7621},
                                                  {-19.0941, 17.774},
                                                  {-19.5915, 17.7858},
                                                  {-20.0889, 17.7976},
                                                  {-20.5863, 17.8094},
                                                  {-21.0838, 17.8213},
                                                  {-21.5813, 17.8331},
                                                  {-22.0787, 17.8449},
                                                  {-22.5763, 17.8568},
                                                  {-23.0738, 17.8686},
                                                  {-23.5713, 17.8804},
                                                  {-24.0689, 17.8923},
                                                  {-24.5665, 17.9041},
                                                  {-25.0641, 17.9159},
                                                  {-25.5617, 17.9278},
                                                  {-26.0593, 17.9396},
                                                  {-26.5569, 17.9514},
                                                  {-27.0546, 17.9633},
                                                  {-27.5522, 17.9751},
                                                  {-28.0498, 17.9869}};
  std::vector<std::pair<double, double>> path{{0, 0},
                                              {0.251862, 9.98908e-05},
                                              {0.503843, 0.000268485},
                                              {0.757589, 0.000502795},
                                              {1.0146, 0.0010219},
                                              {1.27623, 0.00201551},
                                              {1.5437, 0.00365251},
                                              {1.81811, 0.00608563},
                                              {2.10041, 0.00945341},
                                              {2.39147, 0.0138802},
                                              {2.69202, 0.0194751},
                                              {3.00268, 0.0263297},
                                              {3.324, 0.0345164},
                                              {3.65639, 0.0440862},
                                              {4.00021, 0.0550674},
                                              {4.35571, 0.0674651},
                                              {4.72308, 0.081261},
                                              {5.10243, 0.0964147},
                                              {5.4938, 0.112866},
                                              {5.89717, 0.130536},
                                              {6.31244, 0.149334},
                                              {6.7395, 0.169156},
                                              {7.17815, 0.189894},
                                              {7.62815, 0.211436},
                                              {8.08925, 0.23367},
                                              {8.56111, 0.256488},
                                              {9.04341, 0.279788},
                                              {9.53576, 0.303477},
                                              {10.0378, 0.327471},
                                              {10.549, 0.351693},
                                              {11.069, 0.37608},
                                              {11.5973, 0.400575},
                                              {12.1335, 0.425132},
                                              {12.6771, 0.44971},
                                              {13.2275, 0.474279},
                                              {13.7843, 0.49881},
                                              {14.3471, 0.523281},
                                              {14.9152, 0.547675},
                                              {15.4883, 0.571979},
                                              {16.0658, 0.59618},
                                              {16.6474, 0.620274},
                                              {17.2325, 0.644259},
                                              {17.8206, 0.668139},
                                              {18.4115, 0.691925},
                                              {19.0047, 0.715635},
                                              {19.5998, 0.739296},
                                              {20.1964, 0.762949},
                                              {20.7942, 0.786644},
                                              {21.393, 0.810444},
                                              {21.9923, 0.834427},
                                              {22.5921, 0.858686},
                                              {23.1919, 0.883327},
                                              {23.7918, 0.908471},
                                              {24.3914, 0.93425},
                                              {24.9906, 0.960806},
                                              {25.5892, 0.988284},
                                              {26.1871, 1.01683},
                                              {26.784, 1.0466},
                                              {27.3797, 1.07772},
                                              {27.974, 1.11032},
                                              {28.5666, 1.14451},
                                              {29.1575, 1.18036},
                                              {29.7464, 1.21792},
                                              {30.3331, 1.2572},
                                              {30.9173, 1.29817},
                                              {31.499, 1.34074},
                                              {32.0778, 1.38479},
                                              {32.6537, 1.43013},
                                              {33.2265, 1.47654},
                                              {33.796, 1.52373},
                                              {34.3621, 1.57139},
                                              {34.9245, 1.61919},
                                              {35.4833, 1.66676},
                                              {36.0382, 1.71373},
                                              {36.5891, 1.7597},
                                              {37.136, 1.8043},
                                              {37.6787, 1.84716},
                                              {38.217, 1.88796},
                                              {38.751, 1.92638},
                                              {39.2804, 1.96219},
                                              {39.8051, 1.99517},
                                              {40.325, 2.02519},
                                              {40.8401, 2.05222},
                                              {41.3502, 2.07626},
                                              {41.8551, 2.09745},
                                              {42.3548, 2.11598},
                                              {42.8493, 2.13218},
                                              {43.3383, 2.14644},
                                              {43.8218, 2.15928},
                                              {44.2998, 2.1713},
                                              {44.7722, 2.18319},
                                              {45.239, 2.19573},
                                              {45.7, 2.20979},
                                              {46.1553, 2.22629},
                                              {46.6047, 2.2462},
                                              {47.0482, 2.27057},
                                              {47.4857, 2.30046},
                                              {47.917, 2.33693},
                                              {48.3419, 2.38106},
                                              {48.7602, 2.43392},
                                              {49.1715, 2.49654},
                                              {49.5754, 2.56987},
                                              {49.9715, 2.65483},
                                              {50.3592, 2.75222},
                                              {50.7378, 2.86273},
                                              {51.1067, 2.98693},
                                              {51.4651, 3.12525},
                                              {51.8121, 3.27794},
                                              {52.147, 3.44513},
                                              {52.4688, 3.62673},
                                              {52.7767, 3.82251},
                                              {53.07, 4.03205},
                                              {53.3478, 4.25479},
                                              {53.6096, 4.49},
                                              {53.8547, 4.73684},
                                              {54.0828, 4.99436},
                                              {54.2937, 5.26152},
                                              {54.4872, 5.53725},
                                              {54.6634, 5.82045},
                                              {54.8224, 6.11003},
                                              {54.9648, 6.40496},
                                              {55.0908, 6.70423},
                                              {55.2013, 7.00693},
                                              {55.2967, 7.31225},
                                              {55.378, 7.61948},
                                              {55.446, 7.928},
                                              {55.5014, 8.23731},
                                              {55.5456, 8.54702},
                                              {55.5791, 8.85681},
                                              {55.6028, 9.16651},
                                              {55.6168, 9.47602},
                                              {55.6213, 9.78526},
                                              {55.6163, 10.0942},
                                              {55.6015, 10.4027},
                                              {55.5767, 10.7107},
                                              {55.5413, 11.018},
                                              {55.4949, 11.3244},
                                              {55.4367, 11.6297},
                                              {55.3661, 11.9333},
                                              {55.2823, 12.2349},
                                              {55.1847, 12.5338},
                                              {55.0725, 12.8294},
                                              {54.9451, 13.1207},
                                              {54.8017, 13.4068},
                                              {54.642, 13.6867},
                                              {54.4655, 13.9593},
                                              {54.272, 14.2232},
                                              {54.0614, 14.4775},
                                              {53.8338, 14.7206},
                                              {53.5896, 14.9516},
                                              {53.3291, 15.1693},
                                              {53.0532, 15.3728},
                                              {52.7625, 15.5612},
                                              {52.4579, 15.7339},
                                              {52.1407, 15.8907},
                                              {51.8117, 16.0313},
                                              {51.4722, 16.1557},
                                              {51.123, 16.2644},
                                              {50.7651, 16.3577},
                                              {50.3995, 16.4363},
                                              {50.0268, 16.5009},
                                              {49.6479, 16.5524},
                                              {49.2631, 16.5917},
                                              {48.8731, 16.6198},
                                              {48.4781, 16.638},
                                              {48.0785, 16.6472},
                                              {47.6745, 16.6486},
                                              {47.2662, 16.6432},
                                              {46.8537, 16.6322},
                                              {46.4371, 16.6167},
                                              {46.0165, 16.5976},
                                              {45.5918, 16.5758},
                                              {45.1631, 16.5523},
                                              {44.7303, 16.5279},
                                              {44.2936, 16.5032},
                                              {43.853, 16.479},
                                              {43.4084, 16.4559},
                                              {42.96, 16.4342},
                                              {42.5079, 16.4144},
                                              {42.0521, 16.3969},
                                              {41.5927, 16.3818},
                                              {41.1298, 16.3693},
                                              {40.6636, 16.3596},
                                              {40.1942, 16.3526},
                                              {39.7217, 16.3484},
                                              {39.2462, 16.3469},
                                              {38.7679, 16.348},
                                              {38.2869, 16.3514},
                                              {37.8032, 16.3572},
                                              {37.3171, 16.365},
                                              {36.8286, 16.3747},
                                              {36.3379, 16.386},
                                              {35.8451, 16.3988},
                                              {35.3502, 16.4129},
                                              {34.8534, 16.4279},
                                              {34.3549, 16.4438},
                                              {33.8546, 16.4603},
                                              {33.3527, 16.4772},
                                              {32.8494, 16.4945},
                                              {32.3446, 16.5119},
                                              {31.8386, 16.5294},
                                              {31.3314, 16.5468},
                                              {30.8231, 16.564},
                                              {30.3137, 16.581},
                                              {29.8035, 16.5977},
                                              {29.2924, 16.614},
                                              {28.7806, 16.6299},
                                              {28.2681, 16.6454},
                                              {27.755, 16.6606},
                                              {27.2414, 16.6753},
                                              {26.7275, 16.6896},
                                              {26.2131, 16.7035},
                                              {25.6985, 16.7171},
                                              {25.1837, 16.7303},
                                              {24.6687, 16.7432},
                                              {24.1536, 16.7558},
                                              {23.6385, 16.7681},
                                              {23.1234, 16.7803},
                                              {22.6083, 16.7922},
                                              {22.0934, 16.804},
                                              {21.5786, 16.8157},
                                              {21.064, 16.8272},
                                              {20.5497, 16.8387},
                                              {20.0356, 16.8502},
                                              {19.5218, 16.8616},
                                              {19.0084, 16.873},
                                              {18.4953, 16.8844},
                                              {17.9825, 16.8958},
                                              {17.4702, 16.9073},
                                              {16.9583, 16.9187},
                                              {16.4468, 16.9303},
                                              {15.9358, 16.9419},
                                              {15.4252, 16.9535},
                                              {14.915, 16.9652},
                                              {14.4054, 16.9769},
                                              {13.8962, 16.9887},
                                              {13.3875, 17.0006},
                                              {12.8793, 17.0124},
                                              {12.3716, 17.0244},
                                              {11.8643, 17.0363},
                                              {11.3575, 17.0483},
                                              {10.8512, 17.0603},
                                              {10.3454, 17.0724},
                                              {9.83997, 17.0844},
                                              {9.33503, 17.0965},
                                              {8.83053, 17.1086},
                                              {8.32646, 17.1207},
                                              {7.82281, 17.1328},
                                              {7.31957, 17.1449},
                                              {6.81673, 17.1569},
                                              {6.31427, 17.169},
                                              {5.81218, 17.1811},
                                              {5.31046, 17.1931},
                                              {4.80907, 17.2052},
                                              {4.30802, 17.2172},
                                              {3.80728, 17.2292},
                                              {3.30685, 17.2412},
                                              {2.8067, 17.2532},
                                              {2.30683, 17.2651},
                                              {1.80721, 17.2771},
                                              {1.30784, 17.289},
                                              {0.808698, 17.3009},
                                              {0.309771, 17.3128},
                                              {-0.188954, 17.3247},
                                              {-0.687491, 17.3366},
                                              {-1.18585, 17.3484},
                                              {-1.68406, 17.3603},
                                              {-2.18211, 17.3721},
                                              {-2.68003, 17.3839},
                                              {-3.17782, 17.3958},
                                              {-3.6755, 17.4076},
                                              {-4.17309, 17.4194},
                                              {-4.67058, 17.4312},
                                              {-5.16799, 17.443},
                                              {-5.66534, 17.4548},
                                              {-6.16262, 17.4666},
                                              {-6.65986, 17.4784},
                                              {-7.15705, 17.4902},
                                              {-7.65421, 17.5021},
                                              {-8.15134, 17.5139},
                                              {-8.64846, 17.5257},
                                              {-9.14556, 17.5375},
                                              {-9.64266, 17.5493},
                                              {-10.1398, 17.5611},
                                              {-10.6369, 17.5729},
                                              {-11.134, 17.5847},
                                              {-11.6311, 17.5965},
                                              {-12.1282, 17.6083},
                                              {-12.6254, 17.6201},
                                              {-13.1226, 17.632},
                                              {-13.6198, 17.6438},
                                              {-14.1171, 17.6556},
                                              {-14.6144, 17.6674},
                                              {-15.1117, 17.6792},
                                              {-15.609, 17.6911},
                                              {-16.1064, 17.7029},
                                              {-16.6038, 17.7147},
                                              {-17.1013, 17.7266},
                                              {-17.5988, 17.7384},
                                              {-18.0963, 17.7502},
                                              {-18.5939, 17.7621},
                                              {-19.0915, 17.7739},
                                              {-19.5892, 17.7857},
                                              {-20.0869, 17.7976},
                                              {-20.5846, 17.8094},
                                              {-21.0823, 17.8212},
                                              {-21.5801, 17.8331},
                                              {-22.0779, 17.8449},
                                              {-22.5757, 17.8568},
                                              {-23.0736, 17.8686},
                                              {-23.5715, 17.8804},
                                              {-24.0694, 17.8923},
                                              {-24.5673, 17.9041},
                                              {-25.0652, 17.916},
                                              {-25.5632, 17.9278},
                                              {-26.0611, 17.9396},
                                              {-26.5591, 17.9515},
                                              {-27.0571, 17.9633},
                                              {-27.5551, 17.9752},
                                              {-28.053, 17.987}};
  std::vector<std::pair<double, double>> ref{{0, 0},
                                             {0.1, 0},
                                             {0.2, 0},
                                             {0.3, 0},
                                             {0.4, 0},
                                             {0.5, 0},
                                             {0.6, 0},
                                             {0.7, 0},
                                             {0.8, 0},
                                             {0.9, 0},
                                             {1, 0},
                                             {1.1, 0},
                                             {1.2, 0},
                                             {1.3, 0},
                                             {1.4, 0},
                                             {1.5, 0},
                                             {1.6, 0},
                                             {1.7, 0},
                                             {1.8, 0},
                                             {1.9, 0},
                                             {2, 0},
                                             {2.1, 0},
                                             {2.2, 0},
                                             {2.3, 0},
                                             {2.4, 0},
                                             {2.5, 0},
                                             {2.6, 0},
                                             {2.7, 0},
                                             {2.8, 0},
                                             {2.9, 0},
                                             {3, 0},
                                             {3.1, 0},
                                             {3.2, 0},
                                             {3.3, 0},
                                             {3.4, 0},
                                             {3.5, 0},
                                             {3.6, 0},
                                             {3.7, 0},
                                             {3.8, 0},
                                             {3.9, 0},
                                             {4, 0},
                                             {4.1, 0},
                                             {4.2, 0},
                                             {4.3, 0},
                                             {4.4, 0},
                                             {4.5, 0},
                                             {4.6, 0},
                                             {4.7, 0},
                                             {4.8, 0},
                                             {4.9, 0},
                                             {5, 0},
                                             {5.1, 0},
                                             {5.2, 0},
                                             {5.3, 0},
                                             {5.4, 0},
                                             {5.5, 0},
                                             {5.6, 0},
                                             {5.7, 0},
                                             {5.8, 0},
                                             {5.9, 0},
                                             {6, 0},
                                             {6.1, 0},
                                             {6.2, 0},
                                             {6.3, 0},
                                             {6.4, 0},
                                             {6.5, 0},
                                             {6.6, 0},
                                             {6.7, 0},
                                             {6.8, 0},
                                             {6.9, 0},
                                             {7, 0},
                                             {7.1, 0},
                                             {7.2, 0},
                                             {7.3, 0},
                                             {7.4, 0},
                                             {7.5, 0},
                                             {7.6, 0},
                                             {7.7, 0},
                                             {7.8, 0},
                                             {7.9, 0},
                                             {8, 0},
                                             {8.1, 0},
                                             {8.2, 0},
                                             {8.3, 0},
                                             {8.4, 0},
                                             {8.5, 0},
                                             {8.6, 0},
                                             {8.7, 0},
                                             {8.8, 0},
                                             {8.9, 0},
                                             {9, 0},
                                             {9.1, 0},
                                             {9.2, 0},
                                             {9.3, 0},
                                             {9.4, 0},
                                             {9.5, 0},
                                             {9.6, 0},
                                             {9.7, 0},
                                             {9.8, 0},
                                             {9.9, 0},
                                             {10, 0},
                                             {10.1, 0},
                                             {10.2, 0},
                                             {10.3, 0},
                                             {10.4, 0},
                                             {10.5, 0},
                                             {10.6, 0},
                                             {10.7, 0},
                                             {10.8, 0},
                                             {10.9, 0},
                                             {11, 0},
                                             {11.1, 0},
                                             {11.2, 0},
                                             {11.3, 0},
                                             {11.4, 0},
                                             {11.5, 0},
                                             {11.6, 0},
                                             {11.7, 0},
                                             {11.8, 0},
                                             {11.9, 0},
                                             {12, 0},
                                             {12.1, 0},
                                             {12.2, 0},
                                             {12.3, 0},
                                             {12.4, 0},
                                             {12.5, 0},
                                             {12.6, 0},
                                             {12.7, 0},
                                             {12.8, 0},
                                             {12.9, 0},
                                             {13, 0},
                                             {13.1, 0},
                                             {13.2, 0},
                                             {13.3, 0},
                                             {13.4, 0},
                                             {13.5, 0},
                                             {13.6, 0},
                                             {13.7, 0},
                                             {13.8, 0},
                                             {13.9, 0},
                                             {14, 0},
                                             {14.1, 0},
                                             {14.2, 0},
                                             {14.3, 0},
                                             {14.4, 0},
                                             {14.5, 0},
                                             {14.6, 0},
                                             {14.7, 0},
                                             {14.8, 0},
                                             {14.9, 0},
                                             {15, 0},
                                             {15.1, 0},
                                             {15.2, 0},
                                             {15.3, 0},
                                             {15.4, 0},
                                             {15.5, 0},
                                             {15.6, 0},
                                             {15.7, 0},
                                             {15.8, 0},
                                             {15.9, 0},
                                             {16, 0},
                                             {16.1, 0},
                                             {16.2, 0},
                                             {16.3, 0},
                                             {16.4, 0},
                                             {16.5, 0},
                                             {16.6, 0},
                                             {16.7, 0},
                                             {16.8, 0},
                                             {16.9, 0},
                                             {17, 0},
                                             {17.1, 0},
                                             {17.2, 0},
                                             {17.3, 0},
                                             {17.4, 0},
                                             {17.5, 0},
                                             {17.6, 0},
                                             {17.7, 0},
                                             {17.8, 0},
                                             {17.9, 0},
                                             {18, 0},
                                             {18.1, 0},
                                             {18.2, 0},
                                             {18.3, 0},
                                             {18.4, 0},
                                             {18.5, 0},
                                             {18.6, 0},
                                             {18.7, 0},
                                             {18.8, 0},
                                             {18.9, 0},
                                             {19, 0},
                                             {19.1, 0},
                                             {19.2, 0},
                                             {19.3, 0},
                                             {19.4, 0},
                                             {19.5, 0},
                                             {19.6, 0},
                                             {19.7, 0},
                                             {19.8, 0},
                                             {19.9, 0},
                                             {20, 0},
                                             {20.1, 0},
                                             {20.2, 0},
                                             {20.3, 0},
                                             {20.4, 0},
                                             {20.5, 0},
                                             {20.6, 0},
                                             {20.7, 0},
                                             {20.8, 0},
                                             {20.9, 0},
                                             {21, 0},
                                             {21.1, 0},
                                             {21.2, 0},
                                             {21.3, 0},
                                             {21.4, 0},
                                             {21.5, 0},
                                             {21.6, 0},
                                             {21.7, 0},
                                             {21.8, 0},
                                             {21.9, 0},
                                             {22, 0},
                                             {22.1, 0},
                                             {22.2, 0},
                                             {22.3, 0},
                                             {22.4, 0},
                                             {22.5, 0},
                                             {22.6, 0},
                                             {22.7, 0},
                                             {22.8, 0},
                                             {22.9, 0},
                                             {23, 0},
                                             {23.1, 0},
                                             {23.2, 0},
                                             {23.3, 0},
                                             {23.4, 0},
                                             {23.5, 0},
                                             {23.6, 0},
                                             {23.7, 0},
                                             {23.8, 0},
                                             {23.9, 0},
                                             {24, 0},
                                             {24.1, 0},
                                             {24.2, 0},
                                             {24.3, 0},
                                             {24.4, 0},
                                             {24.5, 0},
                                             {24.6, 0},
                                             {24.7, 0},
                                             {24.8, 0},
                                             {24.9, 0},
                                             {25, 0},
                                             {25.1, 0},
                                             {25.2, 0},
                                             {25.3, 0},
                                             {25.4, 0},
                                             {25.5, 0},
                                             {25.6, 0},
                                             {25.7, 0},
                                             {25.8, 0},
                                             {25.9, 0},
                                             {26, 0},
                                             {26.1, 0},
                                             {26.2, 0},
                                             {26.3, 0},
                                             {26.4, 0},
                                             {26.5, 0},
                                             {26.6, 0},
                                             {26.7, 0},
                                             {26.8, 0},
                                             {26.9, 0},
                                             {27, 0},
                                             {27.1, 0},
                                             {27.2, 0},
                                             {27.3, 0},
                                             {27.4, 0},
                                             {27.5, 0},
                                             {27.6, 0},
                                             {27.7, 0},
                                             {27.8, 0},
                                             {27.9, 0},
                                             {28, 0},
                                             {28.1, 0},
                                             {28.2, 0},
                                             {28.3, 0},
                                             {28.4, 0},
                                             {28.5, 0},
                                             {28.6, 0},
                                             {28.7, 0},
                                             {28.8, 0},
                                             {28.9, 0},
                                             {29, 0},
                                             {29.1, 0},
                                             {29.2, 0},
                                             {29.3, 0},
                                             {29.4, 0},
                                             {29.5, 0},
                                             {29.6, 0},
                                             {29.7, 0},
                                             {29.8, 0},
                                             {29.9, 0},
                                             {30, 0},
                                             {30.1, 0},
                                             {30.2, 0},
                                             {30.3, 0},
                                             {30.4, 0},
                                             {30.5, 0},
                                             {30.6, 0},
                                             {30.7, 0},
                                             {30.8, 0},
                                             {30.9, 0},
                                             {31, 0},
                                             {31.1, 0},
                                             {31.2, 0},
                                             {31.3, 0},
                                             {31.4, 0},
                                             {31.5, 0},
                                             {31.6, 0},
                                             {31.7, 0},
                                             {31.8, 0},
                                             {31.9, 0},
                                             {32, 0},
                                             {32.1, 0},
                                             {32.2, 0},
                                             {32.3, 0},
                                             {32.4, 0},
                                             {32.5, 0},
                                             {32.6, 0},
                                             {32.7, 0},
                                             {32.8, 0},
                                             {32.9, 0},
                                             {33, 0},
                                             {33.1, 0},
                                             {33.2, 0},
                                             {33.3, 0},
                                             {33.4, 0},
                                             {33.5, 0},
                                             {33.6, 0},
                                             {33.7, 0},
                                             {33.8, 0},
                                             {33.9, 0},
                                             {34, 0},
                                             {34.1, 0},
                                             {34.2, 0},
                                             {34.3, 0},
                                             {34.4, 0},
                                             {34.5, 0},
                                             {34.6, 0},
                                             {34.7, 0},
                                             {34.8, 0},
                                             {34.9, 0},
                                             {35, 0},
                                             {35.1, 0},
                                             {35.2, 0},
                                             {35.3, 0},
                                             {35.4, 0},
                                             {35.5, 0},
                                             {35.6, 0},
                                             {35.7, 0},
                                             {35.8, 0},
                                             {35.9, 0},
                                             {36, 0},
                                             {36.1, 0},
                                             {36.2, 0},
                                             {36.3, 0},
                                             {36.4, 0},
                                             {36.5, 0},
                                             {36.6, 0},
                                             {36.7, 0},
                                             {36.8, 0},
                                             {36.9, 0},
                                             {37, 0},
                                             {37.1, 0},
                                             {37.2, 0},
                                             {37.3, 0},
                                             {37.4, 0},
                                             {37.5, 0},
                                             {37.6, 0},
                                             {37.7, 0},
                                             {37.8, 0},
                                             {37.9, 0},
                                             {38, 0},
                                             {38.1, 0},
                                             {38.2, 0},
                                             {38.3, 0},
                                             {38.4, 0},
                                             {38.5, 0},
                                             {38.6, 0},
                                             {38.7, 0},
                                             {38.8, 0},
                                             {38.9, 0},
                                             {39, 0},
                                             {39.1, 0},
                                             {39.2, 0},
                                             {39.3, 0},
                                             {39.4, 0},
                                             {39.5, 0},
                                             {39.6, 0},
                                             {39.7, 0},
                                             {39.8, 0},
                                             {39.9, 0},
                                             {40, 0},
                                             {40.1, 0},
                                             {40.2, 0},
                                             {40.3, 0},
                                             {40.4, 0},
                                             {40.5, 0},
                                             {40.6, 0},
                                             {40.7, 0},
                                             {40.8, 0},
                                             {40.9, 0},
                                             {41, 0},
                                             {41.1, 0},
                                             {41.2, 0},
                                             {41.3, 0},
                                             {41.4, 0},
                                             {41.5, 0},
                                             {41.6, 0},
                                             {41.7, 0},
                                             {41.8, 0},
                                             {41.9, 0},
                                             {42, 0},
                                             {42.1, 0},
                                             {42.2, 0},
                                             {42.3, 0},
                                             {42.4, 0},
                                             {42.5, 0},
                                             {42.6, 0},
                                             {42.7, 0},
                                             {42.8, 0},
                                             {42.9, 0},
                                             {43, 0},
                                             {43.1, 0},
                                             {43.2, 0},
                                             {43.3, 0},
                                             {43.4, 0},
                                             {43.5, 0},
                                             {43.6, 0},
                                             {43.7, 0},
                                             {43.8, 0},
                                             {43.9, 0},
                                             {44, 0},
                                             {44.1, 0},
                                             {44.2, 0},
                                             {44.3, 0},
                                             {44.4, 0},
                                             {44.5, 0},
                                             {44.6, 0},
                                             {44.7, 0},
                                             {44.8, 0},
                                             {44.9, 0},
                                             {45, 0},
                                             {45.1, 0},
                                             {45.2, 0},
                                             {45.3, 0},
                                             {45.4, 0},
                                             {45.5, 0},
                                             {45.6, 0},
                                             {45.7, 0},
                                             {45.8, 0},
                                             {45.9, 0},
                                             {46, 0},
                                             {46.1, 0},
                                             {46.2, 0},
                                             {46.3, 0},
                                             {46.4, 0},
                                             {46.5, 0},
                                             {46.6, 0},
                                             {46.7, 0},
                                             {46.8, 0},
                                             {46.9, 0},
                                             {47, 0},
                                             {47.1, 0},
                                             {47.2, 0},
                                             {47.3, 0},
                                             {47.4, 0},
                                             {47.5, 0},
                                             {47.6, 0},
                                             {47.7, 0},
                                             {47.8, 0},
                                             {47.9, 0},
                                             {48, 0},
                                             {48.1, 0},
                                             {48.2, 0},
                                             {48.3, 0},
                                             {48.4, 0},
                                             {48.5, 0},
                                             {48.6, 0},
                                             {48.7, 0},
                                             {48.8, 0},
                                             {48.9, 0},
                                             {49, 0},
                                             {49.1, 0},
                                             {49.2, 0},
                                             {49.3, 0},
                                             {49.4, 0},
                                             {49.5, 0},
                                             {49.6, 0},
                                             {49.7, 0},
                                             {49.8, 0},
                                             {49.9, 0},
                                             {50, 0},
                                             {50, 0},
                                             {50.1004, 0.000503706},
                                             {50.2007, 0.00201477},
                                             {50.3011, 0.00453305},
                                             {50.4014, 0.00805829},
                                             {50.5016, 0.0125901},
                                             {50.6019, 0.0181281},
                                             {50.702, 0.0246717},
                                             {50.8021, 0.0322202},
                                             {50.9021, 0.0407728},
                                             {51.002, 0.0503288},
                                             {51.1018, 0.0608871},
                                             {51.2015, 0.0724467},
                                             {51.3011, 0.0850064},
                                             {51.4006, 0.0985649},
                                             {51.4999, 0.113121},
                                             {51.599, 0.128673},
                                             {51.698, 0.14522},
                                             {51.7969, 0.162759},
                                             {51.8955, 0.181289},
                                             {51.994, 0.200809},
                                             {52.0922, 0.221315},
                                             {52.1902, 0.242807},
                                             {52.2881, 0.265282},
                                             {52.3857, 0.288737},
                                             {52.483, 0.313171},
                                             {52.5801, 0.33858},
                                             {52.677, 0.364963},
                                             {52.7735, 0.392317},
                                             {52.8698, 0.420638},
                                             {52.9658, 0.449925},
                                             {53.0615, 0.480173},
                                             {53.1569, 0.511381},
                                             {53.252, 0.543544},
                                             {53.3467, 0.57666},
                                             {53.4412, 0.610726},
                                             {53.5352, 0.645737},
                                             {53.6289, 0.681691},
                                             {53.7223, 0.718583},
                                             {53.8152, 0.756411},
                                             {53.9078, 0.795169},
                                             {54, 0.834855},
                                             {54.0918, 0.875465},
                                             {54.1832, 0.916993},
                                             {54.2741, 0.959437},
                                             {54.3647, 1.00279},
                                             {54.4547, 1.04705},
                                             {54.5444, 1.09221},
                                             {54.6336, 1.13827},
                                             {54.7223, 1.18523},
                                             {54.8105, 1.23307},
                                             {54.8982, 1.28179},
                                             {54.9855, 1.33139},
                                             {55.0723, 1.38187},
                                             {55.1585, 1.43321},
                                             {55.2442, 1.48542},
                                             {55.3294, 1.53848},
                                             {55.4141, 1.5924},
                                             {55.4982, 1.64717},
                                             {55.5818, 1.70277},
                                             {55.6648, 1.75921},
                                             {55.7472, 1.81648},
                                             {55.829, 1.87458},
                                             {55.9103, 1.93349},
                                             {55.991, 1.99322},
                                             {56.071, 2.05375},
                                             {56.1505, 2.11509},
                                             {56.2293, 2.17722},
                                             {56.3075, 2.24013},
                                             {56.3851, 2.30383},
                                             {56.462, 2.36831},
                                             {56.5383, 2.43355},
                                             {56.6139, 2.49955},
                                             {56.6888, 2.56631},
                                             {56.7631, 2.63382},
                                             {56.8367, 2.70207},
                                             {56.9096, 2.77106},
                                             {56.9818, 2.84078},
                                             {57.0533, 2.91121},
                                             {57.1241, 2.98236},
                                             {57.1942, 3.05422},
                                             {57.2635, 3.12678},
                                             {57.3321, 3.20002},
                                             {57.4, 3.27396},
                                             {57.4672, 3.34857},
                                             {57.5335, 3.42385},
                                             {57.5992, 3.4998},
                                             {57.664, 3.5764},
                                             {57.7281, 3.65364},
                                             {57.7914, 3.73153},
                                             {57.8539, 3.81005},
                                             {57.9157, 3.88919},
                                             {57.9766, 3.96894},
                                             {58.0367, 4.04931},
                                             {58.0961, 4.13027},
                                             {58.1546, 4.21183},
                                             {58.2123, 4.29396},
                                             {58.2691, 4.37668},
                                             {58.3251, 4.45996},
                                             {58.3803, 4.54379},
                                             {58.4347, 4.62818},
                                             {58.4882, 4.71311},
                                             {58.5408, 4.79857},
                                             {58.5926, 4.88455},
                                             {58.6435, 4.97105},
                                             {58.6935, 5.05806},
                                             {58.7427, 5.14556},
                                             {58.791, 5.23356},
                                             {58.8384, 5.32203},
                                             {58.8849, 5.41098},
                                             {58.9305, 5.50038},
                                             {58.9752, 5.59025},
                                             {59.019, 5.68055},
                                             {59.0619, 5.77129},
                                             {59.1039, 5.86246},
                                             {59.145, 5.95404},
                                             {59.1851, 6.04603},
                                             {59.2243, 6.13842},
                                             {59.2626, 6.2312},
                                             {59.3, 6.32435},
                                             {59.3364, 6.41788},
                                             {59.3719, 6.51177},
                                             {59.4064, 6.60601},
                                             {59.44, 6.70059},
                                             {59.4727, 6.79551},
                                             {59.5043, 6.89074},
                                             {59.5351, 6.9863},
                                             {59.5648, 7.08215},
                                             {59.5936, 7.1783},
                                             {59.6215, 7.27473},
                                             {59.6483, 7.37144},
                                             {59.6742, 7.46841},
                                             {59.6992, 7.56563},
                                             {59.7231, 7.66311},
                                             {59.7461, 7.76081},
                                             {59.7681, 7.85875},
                                             {59.7891, 7.9569},
                                             {59.8091, 8.05525},
                                             {59.8281, 8.1538},
                                             {59.8461, 8.25254},
                                             {59.8632, 8.35145},
                                             {59.8792, 8.45053},
                                             {59.8943, 8.54976},
                                             {59.9083, 8.64914},
                                             {59.9214, 8.74866},
                                             {59.9335, 8.8483},
                                             {59.9445, 8.94806},
                                             {59.9546, 9.04793},
                                             {59.9636, 9.14789},
                                             {59.9717, 9.24793},
                                             {59.9787, 9.34806},
                                             {59.9848, 9.44824},
                                             {59.9898, 9.54849},
                                             {59.9938, 9.64878},
                                             {59.9969, 9.7491},
                                             {59.9989, 9.84945},
                                             {59.9999, 9.94982},
                                             {59.9999, 10.0502},
                                             {59.9989, 10.1505},
                                             {59.9969, 10.2509},
                                             {59.9938, 10.3512},
                                             {59.9898, 10.4515},
                                             {59.9848, 10.5518},
                                             {59.9787, 10.6519},
                                             {59.9717, 10.7521},
                                             {59.9636, 10.8521},
                                             {59.9546, 10.9521},
                                             {59.9445, 11.0519},
                                             {59.9335, 11.1517},
                                             {59.9214, 11.2513},
                                             {59.9083, 11.3509},
                                             {59.8943, 11.4502},
                                             {59.8792, 11.5495},
                                             {59.8632, 11.6486},
                                             {59.8461, 11.7475},
                                             {59.8281, 11.8462},
                                             {59.8091, 11.9448},
                                             {59.7891, 12.0431},
                                             {59.7681, 12.1413},
                                             {59.7461, 12.2392},
                                             {59.7231, 12.3369},
                                             {59.6992, 12.4344},
                                             {59.6742, 12.5316},
                                             {59.6483, 12.6286},
                                             {59.6215, 12.7253},
                                             {59.5936, 12.8217},
                                             {59.5648, 12.9179},
                                             {59.5351, 13.0137},
                                             {59.5043, 13.1093},
                                             {59.4727, 13.2045},
                                             {59.44, 13.2994},
                                             {59.4064, 13.394},
                                             {59.3719, 13.4882},
                                             {59.3364, 13.5821},
                                             {59.3, 13.6756},
                                             {59.2626, 13.7688},
                                             {59.2243, 13.8616},
                                             {59.1851, 13.954},
                                             {59.145, 14.046},
                                             {59.1039, 14.1375},
                                             {59.0619, 14.2287},
                                             {59.019, 14.3194},
                                             {58.9752, 14.4098},
                                             {58.9305, 14.4996},
                                             {58.8849, 14.589},
                                             {58.8384, 14.678},
                                             {58.791, 14.7664},
                                             {58.7427, 14.8544},
                                             {58.6935, 14.9419},
                                             {58.6435, 15.0289},
                                             {58.5926, 15.1154},
                                             {58.5408, 15.2014},
                                             {58.4882, 15.2869},
                                             {58.4347, 15.3718},
                                             {58.3803, 15.4562},
                                             {58.3251, 15.54},
                                             {58.2691, 15.6233},
                                             {58.2123, 15.706},
                                             {58.1546, 15.7882},
                                             {58.0961, 15.8697},
                                             {58.0367, 15.9507},
                                             {57.9766, 16.0311},
                                             {57.9157, 16.1108},
                                             {57.8539, 16.19},
                                             {57.7914, 16.2685},
                                             {57.7281, 16.3464},
                                             {57.664, 16.4236},
                                             {57.5992, 16.5002},
                                             {57.5335, 16.5761},
                                             {57.4672, 16.6514},
                                             {57.4, 16.726},
                                             {57.3321, 16.8},
                                             {57.2635, 16.8732},
                                             {57.1942, 16.9458},
                                             {57.1241, 17.0176},
                                             {57.0533, 17.0888},
                                             {56.9818, 17.1592},
                                             {56.9096, 17.2289},
                                             {56.8367, 17.2979},
                                             {56.7631, 17.3662},
                                             {56.6888, 17.4337},
                                             {56.6139, 17.5004},
                                             {56.5383, 17.5665},
                                             {56.462, 17.6317},
                                             {56.3851, 17.6962},
                                             {56.3075, 17.7599},
                                             {56.2293, 17.8228},
                                             {56.1505, 17.8849},
                                             {56.071, 17.9462},
                                             {55.991, 18.0068},
                                             {55.9103, 18.0665},
                                             {55.829, 18.1254},
                                             {55.7472, 18.1835},
                                             {55.6648, 18.2408},
                                             {55.5818, 18.2972},
                                             {55.4982, 18.3528},
                                             {55.4141, 18.4076},
                                             {55.3294, 18.4615},
                                             {55.2442, 18.5146},
                                             {55.1585, 18.5668},
                                             {55.0723, 18.6181},
                                             {54.9855, 18.6686},
                                             {54.8982, 18.7182},
                                             {54.8105, 18.7669},
                                             {54.7223, 18.8148},
                                             {54.6336, 18.8617},
                                             {54.5444, 18.9078},
                                             {54.4547, 18.9529},
                                             {54.3647, 18.9972},
                                             {54.2741, 19.0406},
                                             {54.1832, 19.083},
                                             {54.0918, 19.1245},
                                             {54, 19.1651},
                                             {53.9078, 19.2048},
                                             {53.8152, 19.2436},
                                             {53.7223, 19.2814},
                                             {53.6289, 19.3183},
                                             {53.5352, 19.3543},
                                             {53.4412, 19.3893},
                                             {53.3467, 19.4233},
                                             {53.252, 19.4565},
                                             {53.1569, 19.4886},
                                             {53.0615, 19.5198},
                                             {52.9658, 19.5501},
                                             {52.8698, 19.5794},
                                             {52.7735, 19.6077},
                                             {52.677, 19.635},
                                             {52.5801, 19.6614},
                                             {52.483, 19.6868},
                                             {52.3857, 19.7113},
                                             {52.2881, 19.7347},
                                             {52.1902, 19.7572},
                                             {52.0922, 19.7787},
                                             {51.994, 19.7992},
                                             {51.8955, 19.8187},
                                             {51.7969, 19.8372},
                                             {51.698, 19.8548},
                                             {51.599, 19.8713},
                                             {51.4999, 19.8869},
                                             {51.4006, 19.9014},
                                             {51.3011, 19.915},
                                             {51.2015, 19.9276},
                                             {51.1018, 19.9391},
                                             {51.002, 19.9497},
                                             {50.9021, 19.9592},
                                             {50.8021, 19.9678},
                                             {50.702, 19.9753},
                                             {50.6019, 19.9819},
                                             {50.5016, 19.9874},
                                             {50.4014, 19.9919},
                                             {50.3011, 19.9955},
                                             {50.2007, 19.998},
                                             {50.1004, 19.9995},
                                             {50, 20},
                                             {49.9, 20},
                                             {49.8, 20},
                                             {49.7, 20},
                                             {49.6, 20},
                                             {49.5, 20},
                                             {49.4, 20},
                                             {49.3, 20},
                                             {49.2, 20},
                                             {49.1, 20},
                                             {49, 20},
                                             {48.9, 20},
                                             {48.8, 20},
                                             {48.7, 20},
                                             {48.6, 20},
                                             {48.5, 20},
                                             {48.4, 20},
                                             {48.3, 20},
                                             {48.2, 20},
                                             {48.1, 20},
                                             {48, 20},
                                             {47.9, 20},
                                             {47.8, 20},
                                             {47.7, 20},
                                             {47.6, 20},
                                             {47.5, 20},
                                             {47.4, 20},
                                             {47.3, 20},
                                             {47.2, 20},
                                             {47.1, 20},
                                             {47, 20},
                                             {46.9, 20},
                                             {46.8, 20},
                                             {46.7, 20},
                                             {46.6, 20},
                                             {46.5, 20},
                                             {46.4, 20},
                                             {46.3, 20},
                                             {46.2, 20},
                                             {46.1, 20},
                                             {46, 20},
                                             {45.9, 20},
                                             {45.8, 20},
                                             {45.7, 20},
                                             {45.6, 20},
                                             {45.5, 20},
                                             {45.4, 20},
                                             {45.3, 20},
                                             {45.2, 20},
                                             {45.1, 20},
                                             {45, 20},
                                             {44.9, 20},
                                             {44.8, 20},
                                             {44.7, 20},
                                             {44.6, 20},
                                             {44.5, 20},
                                             {44.4, 20},
                                             {44.3, 20},
                                             {44.2, 20},
                                             {44.1, 20},
                                             {44, 20},
                                             {43.9, 20},
                                             {43.8, 20},
                                             {43.7, 20},
                                             {43.6, 20},
                                             {43.5, 20},
                                             {43.4, 20},
                                             {43.3, 20},
                                             {43.2, 20},
                                             {43.1, 20},
                                             {43, 20},
                                             {42.9, 20},
                                             {42.8, 20},
                                             {42.7, 20},
                                             {42.6, 20},
                                             {42.5, 20},
                                             {42.4, 20},
                                             {42.3, 20},
                                             {42.2, 20},
                                             {42.1, 20},
                                             {42, 20},
                                             {41.9, 20},
                                             {41.8, 20},
                                             {41.7, 20},
                                             {41.6, 20},
                                             {41.5, 20},
                                             {41.4, 20},
                                             {41.3, 20},
                                             {41.2, 20},
                                             {41.1, 20},
                                             {41, 20},
                                             {40.9, 20},
                                             {40.8, 20},
                                             {40.7, 20},
                                             {40.6, 20},
                                             {40.5, 20},
                                             {40.4, 20},
                                             {40.3, 20},
                                             {40.2, 20},
                                             {40.1, 20},
                                             {40, 20},
                                             {39.9, 20},
                                             {39.8, 20},
                                             {39.7, 20},
                                             {39.6, 20},
                                             {39.5, 20},
                                             {39.4, 20},
                                             {39.3, 20},
                                             {39.2, 20},
                                             {39.1, 20},
                                             {39, 20},
                                             {38.9, 20},
                                             {38.8, 20},
                                             {38.7, 20},
                                             {38.6, 20},
                                             {38.5, 20},
                                             {38.4, 20},
                                             {38.3, 20},
                                             {38.2, 20},
                                             {38.1, 20},
                                             {38, 20},
                                             {37.9, 20},
                                             {37.8, 20},
                                             {37.7, 20},
                                             {37.6, 20},
                                             {37.5, 20},
                                             {37.4, 20},
                                             {37.3, 20},
                                             {37.2, 20},
                                             {37.1, 20},
                                             {37, 20},
                                             {36.9, 20},
                                             {36.8, 20},
                                             {36.7, 20},
                                             {36.6, 20},
                                             {36.5, 20},
                                             {36.4, 20},
                                             {36.3, 20},
                                             {36.2, 20},
                                             {36.1, 20},
                                             {36, 20},
                                             {35.9, 20},
                                             {35.8, 20},
                                             {35.7, 20},
                                             {35.6, 20},
                                             {35.5, 20},
                                             {35.4, 20},
                                             {35.3, 20},
                                             {35.2, 20},
                                             {35.1, 20},
                                             {35, 20},
                                             {34.9, 20},
                                             {34.8, 20},
                                             {34.7, 20},
                                             {34.6, 20},
                                             {34.5, 20},
                                             {34.4, 20},
                                             {34.3, 20},
                                             {34.2, 20},
                                             {34.1, 20},
                                             {34, 20},
                                             {33.9, 20},
                                             {33.8, 20},
                                             {33.7, 20},
                                             {33.6, 20},
                                             {33.5, 20},
                                             {33.4, 20},
                                             {33.3, 20},
                                             {33.2, 20},
                                             {33.1, 20},
                                             {33, 20},
                                             {32.9, 20},
                                             {32.8, 20},
                                             {32.7, 20},
                                             {32.6, 20},
                                             {32.5, 20},
                                             {32.4, 20},
                                             {32.3, 20},
                                             {32.2, 20},
                                             {32.1, 20},
                                             {32, 20},
                                             {31.9, 20},
                                             {31.8, 20},
                                             {31.7, 20},
                                             {31.6, 20},
                                             {31.5, 20},
                                             {31.4, 20},
                                             {31.3, 20},
                                             {31.2, 20},
                                             {31.1, 20},
                                             {31, 20},
                                             {30.9, 20},
                                             {30.8, 20},
                                             {30.7, 20},
                                             {30.6, 20},
                                             {30.5, 20},
                                             {30.4, 20},
                                             {30.3, 20},
                                             {30.2, 20},
                                             {30.1, 20},
                                             {30, 20},
                                             {29.9, 20},
                                             {29.8, 20},
                                             {29.7, 20},
                                             {29.6, 20},
                                             {29.5, 20},
                                             {29.4, 20},
                                             {29.3, 20},
                                             {29.2, 20},
                                             {29.1, 20},
                                             {29, 20},
                                             {28.9, 20},
                                             {28.8, 20},
                                             {28.7, 20},
                                             {28.6, 20},
                                             {28.5, 20},
                                             {28.4, 20},
                                             {28.3, 20},
                                             {28.2, 20},
                                             {28.1, 20},
                                             {28, 20},
                                             {27.9, 20},
                                             {27.8, 20},
                                             {27.7, 20},
                                             {27.6, 20},
                                             {27.5, 20},
                                             {27.4, 20},
                                             {27.3, 20},
                                             {27.2, 20},
                                             {27.1, 20},
                                             {27, 20},
                                             {26.9, 20},
                                             {26.8, 20},
                                             {26.7, 20},
                                             {26.6, 20},
                                             {26.5, 20},
                                             {26.4, 20},
                                             {26.3, 20},
                                             {26.2, 20},
                                             {26.1, 20},
                                             {26, 20},
                                             {25.9, 20},
                                             {25.8, 20},
                                             {25.7, 20},
                                             {25.6, 20},
                                             {25.5, 20},
                                             {25.4, 20},
                                             {25.3, 20},
                                             {25.2, 20},
                                             {25.1, 20},
                                             {25, 20},
                                             {24.9, 20},
                                             {24.8, 20},
                                             {24.7, 20},
                                             {24.6, 20},
                                             {24.5, 20},
                                             {24.4, 20},
                                             {24.3, 20},
                                             {24.2, 20},
                                             {24.1, 20},
                                             {24, 20},
                                             {23.9, 20},
                                             {23.8, 20},
                                             {23.7, 20},
                                             {23.6, 20},
                                             {23.5, 20},
                                             {23.4, 20},
                                             {23.3, 20},
                                             {23.2, 20},
                                             {23.1, 20},
                                             {23, 20},
                                             {22.9, 20},
                                             {22.8, 20},
                                             {22.7, 20},
                                             {22.6, 20},
                                             {22.5, 20},
                                             {22.4, 20},
                                             {22.3, 20},
                                             {22.2, 20},
                                             {22.1, 20},
                                             {22, 20},
                                             {21.9, 20},
                                             {21.8, 20},
                                             {21.7, 20},
                                             {21.6, 20},
                                             {21.5, 20},
                                             {21.4, 20},
                                             {21.3, 20},
                                             {21.2, 20},
                                             {21.1, 20},
                                             {21, 20},
                                             {20.9, 20},
                                             {20.8, 20},
                                             {20.7, 20},
                                             {20.6, 20},
                                             {20.5, 20},
                                             {20.4, 20},
                                             {20.3, 20},
                                             {20.2, 20},
                                             {20.1, 20},
                                             {20, 20},
                                             {19.9, 20},
                                             {19.8, 20},
                                             {19.7, 20},
                                             {19.6, 20},
                                             {19.5, 20},
                                             {19.4, 20},
                                             {19.3, 20},
                                             {19.2, 20},
                                             {19.1, 20},
                                             {19, 20},
                                             {18.9, 20},
                                             {18.8, 20},
                                             {18.7, 20},
                                             {18.6, 20},
                                             {18.5, 20},
                                             {18.4, 20},
                                             {18.3, 20},
                                             {18.2, 20},
                                             {18.1, 20},
                                             {18, 20},
                                             {17.9, 20},
                                             {17.8, 20},
                                             {17.7, 20},
                                             {17.6, 20},
                                             {17.5, 20},
                                             {17.4, 20},
                                             {17.3, 20},
                                             {17.2, 20},
                                             {17.1, 20},
                                             {17, 20},
                                             {16.9, 20},
                                             {16.8, 20},
                                             {16.7, 20},
                                             {16.6, 20},
                                             {16.5, 20},
                                             {16.4, 20},
                                             {16.3, 20},
                                             {16.2, 20},
                                             {16.1, 20},
                                             {16, 20},
                                             {15.9, 20},
                                             {15.8, 20},
                                             {15.7, 20},
                                             {15.6, 20},
                                             {15.5, 20},
                                             {15.4, 20},
                                             {15.3, 20},
                                             {15.2, 20},
                                             {15.1, 20},
                                             {15, 20},
                                             {14.9, 20},
                                             {14.8, 20},
                                             {14.7, 20},
                                             {14.6, 20},
                                             {14.5, 20},
                                             {14.4, 20},
                                             {14.3, 20},
                                             {14.2, 20},
                                             {14.1, 20},
                                             {14, 20},
                                             {13.9, 20},
                                             {13.8, 20},
                                             {13.7, 20},
                                             {13.6, 20},
                                             {13.5, 20},
                                             {13.4, 20},
                                             {13.3, 20},
                                             {13.2, 20},
                                             {13.1, 20},
                                             {13, 20},
                                             {12.9, 20},
                                             {12.8, 20},
                                             {12.7, 20},
                                             {12.6, 20},
                                             {12.5, 20},
                                             {12.4, 20},
                                             {12.3, 20},
                                             {12.2, 20},
                                             {12.1, 20},
                                             {12, 20},
                                             {11.9, 20},
                                             {11.8, 20},
                                             {11.7, 20},
                                             {11.6, 20},
                                             {11.5, 20},
                                             {11.4, 20},
                                             {11.3, 20},
                                             {11.2, 20},
                                             {11.1, 20},
                                             {11, 20},
                                             {10.9, 20},
                                             {10.8, 20},
                                             {10.7, 20},
                                             {10.6, 20},
                                             {10.5, 20},
                                             {10.4, 20},
                                             {10.3, 20},
                                             {10.2, 20},
                                             {10.1, 20},
                                             {10, 20},
                                             {9.9, 20},
                                             {9.8, 20},
                                             {9.7, 20},
                                             {9.6, 20},
                                             {9.5, 20},
                                             {9.4, 20},
                                             {9.3, 20},
                                             {9.2, 20},
                                             {9.1, 20},
                                             {9, 20},
                                             {8.9, 20},
                                             {8.8, 20},
                                             {8.7, 20},
                                             {8.6, 20},
                                             {8.5, 20},
                                             {8.4, 20},
                                             {8.3, 20},
                                             {8.2, 20},
                                             {8.1, 20},
                                             {8, 20},
                                             {7.9, 20},
                                             {7.8, 20},
                                             {7.7, 20},
                                             {7.6, 20},
                                             {7.5, 20},
                                             {7.4, 20},
                                             {7.3, 20},
                                             {7.2, 20},
                                             {7.1, 20},
                                             {7, 20},
                                             {6.9, 20},
                                             {6.8, 20},
                                             {6.7, 20},
                                             {6.6, 20},
                                             {6.5, 20},
                                             {6.4, 20},
                                             {6.3, 20},
                                             {6.2, 20},
                                             {6.1, 20},
                                             {6, 20},
                                             {5.9, 20},
                                             {5.8, 20},
                                             {5.7, 20},
                                             {5.6, 20},
                                             {5.5, 20},
                                             {5.4, 20},
                                             {5.3, 20},
                                             {5.2, 20},
                                             {5.1, 20},
                                             {5, 20},
                                             {4.9, 20},
                                             {4.8, 20},
                                             {4.7, 20},
                                             {4.6, 20},
                                             {4.5, 20},
                                             {4.4, 20},
                                             {4.3, 20},
                                             {4.2, 20},
                                             {4.1, 20},
                                             {4, 20},
                                             {3.9, 20},
                                             {3.8, 20},
                                             {3.7, 20},
                                             {3.6, 20},
                                             {3.5, 20},
                                             {3.4, 20},
                                             {3.3, 20},
                                             {3.2, 20},
                                             {3.1, 20},
                                             {3, 20},
                                             {2.9, 20},
                                             {2.8, 20},
                                             {2.7, 20},
                                             {2.6, 20},
                                             {2.5, 20},
                                             {2.4, 20},
                                             {2.3, 20},
                                             {2.2, 20},
                                             {2.1, 20},
                                             {2, 20},
                                             {1.9, 20},
                                             {1.8, 20},
                                             {1.7, 20},
                                             {1.6, 20},
                                             {1.5, 20},
                                             {1.4, 20},
                                             {1.3, 20},
                                             {1.2, 20},
                                             {1.1, 20},
                                             {1, 20},
                                             {0.9, 20},
                                             {0.8, 20},
                                             {0.7, 20},
                                             {0.6, 20},
                                             {0.5, 20},
                                             {0.4, 20},
                                             {0.3, 20},
                                             {0.2, 20},
                                             {0.1, 20},
                                             {-6.38378e-16, 20}};

  std::vector<double> ref_x, ref_y, ref_kappa, ref_dkappa;
  std::vector<double> path_x, path_y, path_kappa, path_dkappa;
  std::vector<double> opt_path_x, opt_path_y, opt_path_kappa, opt_path_dkappa;
  std::cout << "ref:" << ref.size() << "," << path.size() << '\n';
  for (std::size_t i = 0; i < ref.size(); i += 4) {
    ref_x.push_back(ref.at(i).first);
    ref_y.push_back(ref.at(i).second);
  }

  for (std::size_t i = 0; i < path.size() - 57; ++i) {
    path_x.push_back(path.at(i).first);
    path_y.push_back(path.at(i).second);
    opt_path_x.push_back(opt_path.at(i).first);
    opt_path_y.push_back(opt_path.at(i).second);
  }
  cal_path_kappa(ref_x, ref_y, ref_kappa, ref_dkappa);
  cal_path_kappa(path_x, path_y, path_kappa, path_dkappa);
  cal_path_kappa(opt_path_x, opt_path_y, opt_path_kappa, opt_path_dkappa);

#endif
  //  read_csv(raw_points_);
#if 1
  std::vector<double> theta;
  std::vector<double> kappa;
  std::vector<double> dkappa;
  std::vector<double> s;
  std::vector<double> spiral_x;
  std::vector<double> spiral_y;
  std::vector<double> spiral_final_kappas, spiral_final_dkappas;
  spiral_smoother(raw_points_, &theta, &kappa, &dkappa, &s, &spiral_x,
                  &spiral_y);
  cal_path_kappa(spiral_x, spiral_y, spiral_final_kappas, spiral_final_dkappas);
  plt::subplot(2, 1, 1);
  plt::named_plot("refrenceline_XY", ref_x, ref_y);
  plt::named_plot("spiral_ipopt_xy", spiral_x, spiral_y);
  plt::xlabel("X(m)");
  plt::ylabel("Y(m)");
  plt::axis("equal");
  plt::legend();
  plt::subplot(2, 1, 2);
  // plt::named_plot("spiral_dkappa", dkappa,"r");
  plt::named_plot("spiral_kappa", kappa);
  plt::xlabel("Distance(m)");
  plt::ylabel("Curvature(1/m)");
  plt::legend();
#endif
  /************************************************************************/
#if 0
  std::vector<double> sloveX, sloveY, qp_final_kappas, qp_final_dkappas;
  qp_spline_smoother(raw_points_, sloveX, sloveY);
  cal_path_kappa(sloveX, sloveY, qp_final_kappas, qp_final_dkappas);
  plt::subplot(2, 1, 1);
  plt::named_plot("refrenceline_XY", ref_x, ref_y);
  plt::named_plot("qp_spline", sloveX, sloveY);
  plt::xlabel("X(m)");
  plt::ylabel("Y(m)");
  plt::axis("equal");
  plt::legend();
  plt::subplot(2, 1, 2);
  // plt::named_plot("ref_kappa", ref_kappa);
  // plt::named_plot("path_kappa", path_kappa);
  // plt::named_plot("path_kappa", opt_path_kappa, "g");
  plt::named_plot("qp_kappa", qp_final_kappas);
  // plt::named_plot("qp_dkappa", qp_final_dkappas,"r");
  plt::xlabel("Distance(m)");
  plt::ylabel("Curvature(1/m)");
  // plt::axis("equal");

  // plt::named_plot("qp_kappa", qp_final_kappas);
  // plt::named_plot("qp_dkappa", qp_final_dkappas,"r");
  plt::legend();

#endif

  /************************************************************************/
#if 0
     std::vector<double> raw_xs, raw_ys;
     div_circle(raw_xs, raw_ys, 5, 1);
  
     std::vector<double> hermit_sloveX, hermit_sloveY;
     hermit_spiral(raw_xs, raw_ys, hermit_sloveX, hermit_sloveY);
     plt::named_plot("hermit_spiral_ceres", hermit_sloveX, hermit_sloveY);
#endif
  /************************************************************************/

  // write_to_csv(spiral_x, spiral_y);

  plt::show();

  return 0;
}